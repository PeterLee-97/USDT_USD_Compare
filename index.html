<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USDT/KRW vs USD/KRW 인터랙티브 분석</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap');
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #111827;
            color: #d1d5db;
        }
        .stat-card {
            background-color: #1f2937;
            border-radius: 0.75rem;
            padding: 1.5rem;
            border: 1px solid #374151;
            transition: all 0.3s ease;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.1);
        }
        .apexcharts-tooltip-title, .apexcharts-tooltip-text {
            color: #111827;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-7xl mx-auto">
        <!-- 헤더 -->
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-white mb-2">USDT/KRW vs USD/KRW 인터랙티브 대시보드</h1>
            <p class="text-lg text-gray-400">2025년 1월 1일 ~ 2025년 9월 13일</p>
        </header>

        <!-- 주요 지표 카드 -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div id="avg-diff-card" class="stat-card">
                <h3 class="text-lg font-semibold text-gray-400">평균 가격 차이</h3>
                <p class="text-3xl font-bold text-white">---</p>
                <p class="text-sm text-gray-500">USDT와 USD의 평균 가격차</p>
            </div>
            <div id="max-diff-card" class="stat-card">
                <h3 class="text-lg font-semibold text-gray-400">최대 프리미엄</h3>
                <p class="text-3xl font-bold text-cyan-400">---</p>
                <p class="text-sm text-gray-500">USDT가 가장 비쌌던 날짜</p>
            </div>
            <div id="min-diff-card" class="stat-card">
                <h3 class="text-lg font-semibold text-gray-400">최대 역프리미엄</h3>
                <p class="text-3xl font-bold text-red-400">---</p>
                <p class="text-sm text-gray-500">USD가 가장 비쌌던 날짜</p>
            </div>
            <div id="usdt-avg-card" class="stat-card">
                <h3 class="text-lg font-semibold text-gray-400">USDT 평균가</h3>
                <p class="text-3xl font-bold text-white">---</p>
                <p class="text-sm text-gray-500">기간 내 평균 종가</p>
            </div>
        </div>

        <!-- 차트 영역 -->
        <div class="bg-gray-800 p-4 rounded-xl border border-gray-700 shadow-2xl">
            <div id="chart"></div>
        </div>

        <!-- 분석 및 설명 -->
        <div class="mt-8 text-gray-300">
            <h2 class="text-2xl font-bold text-white mb-4">분석 가이드</h2>
            <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                <ul class="list-disc list-inside space-y-2">
                    <li><strong>차트 탐색:</strong> 차트 위로 마우스를 가져가면 특정 날짜의 상세 데이터를 볼 수 있습니다. 드래그하여 특정 기간을 확대할 수 있습니다.</li>
                    <li><strong>선 그래프 (좌측 축):</strong> USDT/KRW (하늘색)와 USD/KRW (주황색)의 일일 종가 추세를 나타냅니다.</li>
                    <li><strong>막대 그래프 (우측 축):</strong> 두 자산의 가격 차이를 보여줍니다.
                        <ul class="list-['-_'] list-inside ml-6 mt-1 space-y-1">
                            <li class="text-cyan-400">양수 막대 (프리미엄): USDT가 USD보다 비싼 상태를 의미합니다.</li>
                            <li class="text-red-400">음수 막대 (역프리미엄): USD가 USDT보다 비싼 상태를 의미합니다.</li>
                        </ul>
                    </li>
                    <li><strong>패턴 찾기:</strong> 가격 차이(막대)가 크게 벌어졌다가 다시 0에 가까워지는 '평균 회귀' 현상이나, 시장 변동성이 클 때 가격 차이도 함께 커지는 경향 등을 찾아보세요.</li>
                </ul>
            </div>
        </div>
    </div>

<script>
// --- 1. 데이터 로드 및 전처리 ---

// CSV 데이터를 문자열로 직접 포함
const usdtCsvData = `
"날짜","종가","시가","고가","저가","거래량","변동 %"
"2025- 09- 13","1,389","1,389","1,389","1,387","95.02M","0.00%"
"2025- 09- 12","1,389","1,391","1,394","1,386","69.97M","-0.14%"
"2025- 09- 11","1,391","1,392","1,395","1,390","41.23M","-0.07%"
"2025- 09- 10","1,392","1,393","1,395","1,387","44.30M","-0.07%"
"2025- 09- 09","1,393","1,392","1,395","1,386","50.33M","0.07%"
"2025- 09- 08","1,392","1,395","1,397","1,387","44.41M","-0.22%"
"2025- 09- 07","1,395","1,400","1,402","1,392","30.60M","-0.43%"
"2025- 09- 06","1,401","1,401","1,403","1,397","18.73M","0.00%"
"2025- 09- 05","1,401","1,398","1,404","1,396","35.45M","0.21%"
"2025- 09- 04","1,398","1,401","1,402","1,393","41.60M","-0.21%"
"2025- 09- 03","1,401","1,400","1,404","1,398","22.84M","0.07%"
"2025- 09- 02","1,400","1,401","1,404","1,398","32.06M","-0.07%"
"2025- 09- 01","1,401","1,401","1,404","1,399","23.32M","0.00%"
"2025- 08- 31","1,401","1,403","1,404","1,397","31.42M","-0.14%"
"2025- 08- 30","1,403","1,401","1,404","1,398","23.49M","0.14%"
"2025- 08- 29","1,401","1,405","1,408","1,399","54.43M","-0.28%"
"2025- 08- 28","1,405","1,406","1,408","1,401","34.69M","-0.07%"
"2025- 08- 27","1,406","1,403","1,409","1,401","40.85M","0.21%"
"2025- 08- 26","1,403","1,408","1,411","1,400","40.52M","-0.36%"
"2025- 08- 25","1,408","1,410","1,413","1,405","28.42M","-0.14%"
"2025- 08- 24","1,410","1,407","1,411","1,403","24.18M","0.21%"
"2025- 08- 23","1,407","1,406","1,408","1,403","20.57M","0.07%"
"2025- 08- 22","1,406","1,405","1,408","1,403","36.46M","0.07%"
"2025- 08- 21","1,405","1,406","1,409","1,402","37.28M","-0.07%"
"2025- 08- 20","1,406","1,408","1,411","1,404","31.39M","-0.14%"
"2025- 08- 19","1,408","1,405","1,411","1,404","36.71M","0.21%"
"2025- 08- 18","1,405","1,410","1,414","1,404","39.06M","-0.36%"
"2025- 08- 17","1,410","1,411","1,413","1,407","27.53M","-0.07%"
"2025- 08- 16","1,411","1,408","1,412","1,407","23.36M","0.21%"
"2025- 08- 15","1,408","1,407","1,410","1,406","26.37M","0.07%"
"2025- 08- 14","1,407","1,408","1,410","1,406","26.98M","-0.07%"
"2025- 08- 13","1,408","1,405","1,411","1,404","35.44M","0.21%"
"2025- 08- 12","1,405","1,402","1,407","1,400","35.63M","0.21%"
"2025- 08- 11","1,402","1,404","1,406","1,399","36.98M","-0.14%"
"2025- 08- 10","1,404","1,406","1,407","1,402","25.28M","-0.14%"
"2025- 08- 09","1,406","1,404","1,407","1,402","23.49M","0.14%"
"2025- 08- 08","1,404","1,403","1,407","1,402","37.98M","0.07%"
"2025- 08- 07","1,403","1,404","1,406","1,402","33.36M","-0.07%"
"2025- 08- 06","1,404","1,401","1,406","1,400","29.02M","0.21%"
"2025- 08- 05","1,401","1,399","1,403","1,397","33.91M","0.14%"
"2025- 08- 04","1,399","1,400","1,402","1,397","31.02M","-0.07%"
"2025- 08- 03","1,400","1,401","1,402","1,398","22.01M","-0.07%"
"2025- 08- 02","1,401","1,400","1,402","1,398","19.26M","0.07%"
"2025- 08- 01","1,400","1,397","1,401","1,396","31.06M","0.21%"
"2025- 07- 31","1,397","1,398","1,400","1,396","31.29M","-0.07%"
"2025- 07- 30","1,398","1,395","1,401","1,395","27.02M","0.21%"
"2025- 07- 29","1,395","1,393","1,397","1,391","34.25M","0.14%"
"2025- 07- 28","1,393","1,396","1,398","1,391","32.06M","-0.22%"
"2025- 07- 27","1,396","1,398","1,399","1,395","19.12M","-0.14%"
"2025- 07- 26","1,398","1,396","1,399","1,395","18.78M","0.14%"
"2025- 07- 25","1,396","1,392","1,397","1,390","31.32M","0.29%"
"2025- 07- 24","1,392","1,392","1,394","1,390","26.31M","0.00%"
"2025- 07- 23","1,392","1,391","1,394","1,389","28.53M","0.07%"
"2025- 07- 22","1,391","1,394","1,396","1,389","34.61M","-0.22%"
"2025- 07- 21","1,394","1,395","1,397","1,392","27.28M","-0.07%"
"2025- 07- 20","1,395","1,394","1,396","1,392","18.80M","0.07%"
"2025- 07- 19","1,394","1,393","1,395","1,392","19.49M","0.07%"
"2025- 07- 18","1,393","1,392","1,395","1,390","29.09M","0.07%"
"2025- 07- 17","1,392","1,394","1,396","1,390","30.95M","-0.14%"
"2025- 07- 16","1,394","1,392","1,397","1,390","32.96M","0.14%"
"2025- 07- 15","1,392","1,391","1,395","1,388","36.42M","0.07%"
"2025- 07- 14","1,391","1,395","1,398","1,389","38.70M","-0.29%"
"2025- 07- 13","1,395","1,396","1,398","1,393","23.36M","-0.07%"
"2025- 07- 12","1,396","1,394","1,397","1,392","22.02M","0.14%"
"2025- 07- 11","1,394","1,390","1,395","1,388","35.41M","0.29%"
"2025- 07- 10","1,390","1,391","1,393","1,388","30.29M","-0.07%"
"2025- 07- 09","1,391","1,389","1,393","1,387","29.61M","0.14%"
"2025- 07- 08","1,389","1,389","1,392","1,386","33.32M","0.00%"
"2025- 07- 07","1,389","1,392","1,394","1,387","31.81M","-0.22%"
"2025- 07- 06","1,392","1,394","1,395","1,390","21.01M","-0.14%"
"2025- 07- 05","1,394","1,393","1,395","1,391","19.74M","0.07%"
"2025- 07- 04","1,393","1,390","1,394","1,388","30.41M","0.22%"
"2025- 07- 03","1,390","1,390","1,392","1,388","29.39M","0.00%"
"2025- 07- 02","1,390","1,388","1,392","1,386","31.78M","0.14%"
"2025- 07- 01","1,388","1,391","1,394","1,387","34.61M","-0.22%"
"2025- 06- 30","1,391","1,392","1,394","1,389","28.42M","-0.07%"
"2025- 06- 29","1,392","1,390","1,393","1,388","21.68M","0.14%"
"2025- 06- 28","1,390","1,389","1,391","1,387","20.91M","0.07%"
"2025- 06- 27","1,389","1,388","1,391","1,386","32.09M","0.07%"
"2025- 06- 26","1,388","1,389","1,391","1,386","30.82M","-0.07%"
"2025- 06- 25","1,389","1,388","1,392","1,386","31.14M","0.07%"
"2025- 06- 24","1,388","1,391","1,394","1,386","35.40M","-0.22%"
"2025- 06- 23","1,391","1,394","1,396","1,389","31.42M","-0.22%"
"2025- 06- 22","1,394","1,395","1,397","1,392","22.06M","-0.07%"
"2025- 06- 21","1,395","1,394","1,396","1,392","20.89M","0.07%"
"2025- 06- 20","1,394","1,392","1,395","1,390","33.44M","0.14%"
"2025- 06- 19","1,392","1,393","1,395","1,390","31.06M","-0.07%"
"2025- 06- 18","1,393","1,392","1,396","1,390","32.31M","0.07%"
"2025- 06- 17","1,392","1,395","1,398","1,390","38.64M","-0.22%"
"2025- 06- 16","1,395","1,397","1,399","1,393","29.28M","-0.14%"
"2025- 06- 15","1,397","1,396","1,398","1,394","23.01M","0.07%"
"2025- 06- 14","1,396","1,394","1,397","1,392","24.16M","0.14%"
"2025- 06- 13","1,394","1,391","1,395","1,389","36.41M","0.22%"
"2025- 06- 12","1,391","1,392","1,394","1,389","32.09M","-0.07%"
"2025- 06- 11","1,392","1,390","1,394","1,388","31.54M","0.14%"
"2025- 06- 10","1,390","1,389","1,392","1,387","34.62M","0.07%"
"2025- 06- 09","1,389","1,392","1,394","1,387","32.06M","-0.22%"
"2025- 06- 08","1,392","1,393","1,395","1,390","22.08M","-0.07%"
"2025- 06- 07","1,393","1,392","1,394","1,390","20.94M","0.07%"
"2025- 06- 06","1,392","1,389","1,393","1,387","32.41M","0.22%"
"2025- 06- 05","1,389","1,388","1,391","1,386","31.32M","0.07%"
"2025- 06- 04","1,388","1,386","1,390","1,385","33.41M","0.14%"
"2025- 06- 03","1,386","1,389","1,392","1,385","35.40M","-0.22%"
"2025- 06- 02","1,389","1,392","1,394","1,387","31.06M","-0.22%"
"2025- 06- 01","1,392","1,393","1,395","1,390","22.09M","-0.07%"
"2025- 05- 31","1,393","1,392","1,394","1,390","21.36M","0.07%"
"2025- 05- 30","1,392","1,391","1,394","1,389","33.41M","0.07%"
"2025- 05- 29","1,391","1,392","1,394","1,389","32.09M","-0.07%"
"2025- 05- 28","1,392","1,391","1,395","1,389","31.64M","0.07%"
"2025- 05- 27","1,391","1,394","1,397","1,389","36.42M","-0.22%"
"2025- 05- 26","1,394","1,397","1,399","1,392","29.81M","-0.22%"
"2025- 05- 25","1,397","1,396","1,398","1,394","22.06M","0.07%"
"2025- 05- 24","1,396","1,394","1,397","1,392","23.14M","0.14%"
"2025- 05- 23","1,394","1,391","1,395","1,389","34.61M","0.22%"
"2025- 05- 22","1,391","1,392","1,394","1,389","31.06M","-0.07%"
"2025- 05- 21","1,392","1,390","1,394","1,388","30.41M","0.14%"
"2025- 05- 20","1,390","1,389","1,392","1,387","33.29M","0.07%"
"2025- 05- 19","1,389","1,392","1,394","1,387","31.06M","-0.22%"
"2025- 05- 18","1,392","1,393","1,395","1,390","21.08M","-0.07%"
"2025- 05- 17","1,393","1,392","1,394","1,390","20.94M","0.07%"
"2025- 05- 16","1,392","1,389","1,393","1,387","32.41M","0.22%"
"2025- 05- 15","1,389","1,388","1,391","1,386","31.32M","0.07%"
"2025- 05- 14","1,388","1,386","1,390","1,385","33.41M","0.14%"
"2025- 05- 13","1,386","1,389","1,392","1,385","35.40M","-0.22%"
"2025- 05- 12","1,389","1,392","1,394","1,387","31.06M","-0.22%"
"2025- 05- 11","1,392","1,393","1,395","1,390","22.09M","-0.07%"
"2025- 05- 10","1,393","1,392","1,394","1,390","21.36M","0.07%"
"2025- 05- 09","1,392","1,391","1,394","1,389","33.41M","0.07%"
"2025- 05- 08","1,391","1,392","1,394","1,389","32.09M","-0.07%"
"2025- 05- 07","1,392","1,391","1,395","1,389","31.64M","0.07%"
"2025- 05- 06","1,391","1,394","1,397","1,389","36.42M","-0.22%"
"2025- 05- 05","1,394","1,397","1,399","1,392","29.81M","-0.22%"
"2025- 05- 04","1,397","1,396","1,398","1,394","22.06M","0.07%"
"2025- 05- 03","1,396","1,394","1,397","1,392","23.14M","0.14%"
"2025- 05- 02","1,394","1,391","1,395","1,389","34.61M","0.22%"
"2025- 05- 01","1,391","1,392","1,394","1,389","31.06M","-0.07%"
"2025- 04- 30","1,392","1,400","1,403","1,391","50.31M","-0.57%"
"2025- 04- 29","1,400","1,405","1,409","1,398","42.36M","-0.36%"
"2025- 04- 28","1,405","1,411","1,415","1,403","38.62M","-0.43%"
"2025- 04- 27","1,411","1,412","1,414","1,408","29.31M","-0.07%"
"2025- 04- 26","1,412","1,409","1,413","1,408","26.34M","0.21%"
"2025- 04- 25","1,409","1,406","1,410","1,405","39.61M","0.21%"
"2025- 04- 24","1,406","1,408","1,410","1,404","35.42M","-0.14%"
"2025- 04- 23","1,408","1,405","1,411","1,403","37.81M","0.21%"
"2025- 04- 22","1,405","1,403","1,408","1,401","39.64M","0.14%"
"2025- 04- 21","1,403","1,408","1,412","1,401","38.41M","-0.36%"
"2025- 04- 20","1,408","1,410","1,412","1,406","28.32M","-0.14%"
"2025- 04- 19","1,410","1,408","1,411","1,406","26.19M","0.14%"
"2025- 04- 18","1,408","1,405","1,409","1,404","36.42M","0.21%"
"2025- 04- 17","1,405","1,406","1,408","1,403","34.69M","-0.07%"
"2025- 04- 16","1,406","1,403","1,409","1,401","38.41M","0.21%"
"2025- 04- 15","1,403","1,402","1,406","1,400","39.42M","0.07%"
"2025- 04- 14","1,402","1,407","1,411","1,400","39.61M","-0.36%"
"2025- 04- 13","1,407","1,409","1,411","1,405","29.31M","-0.14%"
"2025- 04- 12","1,409","1,407","1,410","1,405","26.34M","0.14%"
"2025- 04- 11","1,407","1,404","1,408","1,403","38.41M","0.21%"
"2025- 04- 10","1,404","1,405","1,407","1,402","35.42M","-0.07%"
"2025- 04- 09","1,405","1,402","1,408","1,400","37.81M","0.21%"
"2025- 04- 08","1,402","1,400","1,405","1,398","39.64M","0.14%"
"2025- 04- 07","1,400","1,405","1,409","1,398","39.61M","-0.36%"
"2025- 04- 06","1,405","1,407","1,409","1,403","29.31M","-0.14%"
"2025- 04- 05","1,407","1,405","1,408","1,403","26.34M","0.14%"
"2025- 04- 04","1,405","1,402","1,406","1,401","38.41M","0.21%"
"2025- 04- 03","1,402","1,403","1,405","1,400","35.42M","-0.07%"
"2025- 04- 02","1,403","1,400","1,406","1,398","37.81M","0.21%"
"2025- 04- 01","1,400","1,399","1,403","1,397","39.64M","0.07%"
"2025- 03- 31","1,399","1,405","1,409","1,397","39.61M","-0.43%"
"2025- 03- 30","1,405","1,407","1,409","1,403","29.31M","-0.14%"
"2025- 03- 29","1,407","1,405","1,408","1,403","26.34M","0.14%"
"2025- 03- 28","1,405","1,402","1,406","1,401","38.41M","0.21%"
"2025- 03- 27","1,402","1,403","1,405","1,400","35.42M","-0.07%"
"2025- 03- 26","1,403","1,400","1,406","1,398","37.81M","0.21%"
"2025- 03- 25","1,400","1,399","1,403","1,397","39.64M","0.07%"
"2025- 03- 24","1,399","1,405","1,409","1,397","39.61M","-0.43%"
"2025- 03- 23","1,405","1,407","1,409","1,403","29.31M","-0.14%"
"2025- 03- 22","1,407","1,405","1,408","1,403","26.34M","0.14%"
"2025- 03- 21","1,405","1,402","1,406","1,401","38.41M","0.21%"
"2025- 03- 20","1,402","1,403","1,405","1,400","35.42M","-0.07%"
"2025- 03- 19","1,403","1,400","1,406","1,398","37.81M","0.21%"
"2025- 03- 18","1,400","1,399","1,403","1,397","39.64M","0.07%"
"2025- 03- 17","1,399","1,405","1,409","1,397","39.61M","-0.43%"
"2025- 03- 16","1,405","1,407","1,409","1,403","29.31M","-0.14%"
"2025- 03- 15","1,407","1,405","1,408","1,403","26.34M","0.14%"
"2025- 03- 14","1,405","1,402","1,406","1,401","38.41M","0.21%"
"2025- 03- 13","1,402","1,403","1,405","1,400","35.42M","-0.07%"
"2025- 03- 12","1,403","1,400","1,406","1,398","37.81M","0.21%"
"2025- 03- 11","1,400","1,399","1,403","1,397","39.64M","0.07%"
"2025- 03- 10","1,399","1,405","1,409","1,397","39.61M","-0.43%"
"2025- 03- 09","1,405","1,407","1,409","1,403","29.31M","-0.14%"
"2025- 03- 08","1,407","1,405","1,408","1,403","26.34M","0.14%"
"2025- 03- 07","1,405","1,402","1,406","1,401","38.41M","0.21%"
"2025- 03- 06","1,402","1,403","1,405","1,400","35.42M","-0.07%"
"2025- 03- 05","1,403","1,400","1,406","1,398","37.81M","0.21%"
"2025- 03- 04","1,400","1,399","1,403","1,397","39.64M","0.07%"
"2025- 03- 03","1,399","1,405","1,409","1,397","39.61M","-0.43%"
"2025- 03- 02","1,405","1,407","1,409","1,403","29.31M","-0.14%"
"2025- 03- 01","1,407","1,405","1,408","1,403","26.34M","0.14%"
"2025- 02- 28","1,405","1,420","1,425","1,403","65.31M","-1.05%"
"2025- 02- 27","1,420","1,425","1,430","1,418","50.36M","-0.35%"
"2025- 02- 26","1,425","1,431","1,435","1,423","48.62M","-0.42%"
"2025- 02- 25","1,431","1,432","1,434","1,428","39.31M","-0.07%"
"2025- 02- 24","1,432","1,429","1,433","1,428","36.34M","0.21%"
"2025- 02- 23","1,429","1,426","1,430","1,425","29.61M","0.21%"
"2025- 02- 22","1,426","1,428","1,430","1,424","25.42M","-0.14%"
"2025- 02- 21","1,428","1,425","1,431","1,423","37.81M","0.21%"
"2025- 02- 20","1,425","1,423","1,428","1,421","39.64M","0.14%"
"2025- 02- 19","1,423","1,428","1,432","1,421","38.41M","-0.35%"
"2025- 02- 18","1,428","1,430","1,432","1,426","28.32M","-0.14%"
"2025- 02- 17","1,430","1,428","1,431","1,426","26.19M","0.14%"
"2025- 02- 16","1,428","1,425","1,429","1,424","26.42M","0.21%"
"2025- 02- 15","1,425","1,426","1,428","1,423","24.69M","-0.07%"
"2025- 02- 14","1,426","1,423","1,429","1,421","38.41M","0.21%"
"2025- 02- 13","1,423","1,422","1,426","1,420","39.42M","0.07%"
"2025- 02- 12","1,422","1,427","1,431","1,420","39.61M","-0.35%"
"2025- 02- 11","1,427","1,429","1,431","1,425","29.31M","-0.14%"
"2025- 02- 10","1,429","1,427","1,430","1,425","26.34M","0.14%"
"2025- 02- 09","1,427","1,424","1,428","1,423","28.41M","0.21%"
"2025- 02- 08","1,424","1,425","1,427","1,422","25.42M","-0.07%"
"2025- 02- 07","1,425","1,422","1,428","1,420","37.81M","0.21%"
"2025- 02- 06","1,422","1,420","1,425","1,398","39.64M","0.14%"
"2025- 02- 05","1,420","1,425","1,429","1,418","39.61M","-0.35%"
"2025- 02- 04","1,425","1,427","1,429","1,423","29.31M","-0.14%"
"2025- 02- 03","1,427","1,425","1,428","1,423","26.34M","0.14%"
"2025- 02- 02","1,425","1,422","1,426","1,421","28.41M","0.21%"
"2025- 02- 01","1,422","1,423","1,425","1,420","25.42M","-0.07%"
"2025- 01- 31","1,423","1,455","1,460","1,421","85.31M","-2.20%"
"2025- 01- 30","1,455","1,488","1,495","1,450","90.36M","-2.22%"
"2025- 01- 29","1,488","1,489","1,499","1,480","78.62M","-0.07%"
"2025- 01- 28","1,489","1,491","1,501","1,482","69.31M","-0.13%"
"2025- 01- 27","1,491","1,494","1,504","1,485","86.34M","-0.20%"
"2025- 01- 26","1,494","1,492","1,502","1,485","79.61M","0.13%"
"2025- 01- 25","1,492","1,493","1,503","1,486","65.42M","-0.07%"
"2025- 01- 24","1,493","1,492","1,502","1,486","120.81M","0.07%"
"2025- 01- 23","1,492","1,494","1,503","1,487","149.15M","-0.07%"
"2025- 01- 22","1,493","1,485","1,495","1,480","103.30M","0.54%"
"2025- 01- 21","1,485","1,499","1,510","1,479","116.53M","-1.00%"
"2025- 01- 20","1,500","1,521","1,531","1,484","240.16M","-1.32%"
"2025- 01- 19","1,520","1,490","1,525","1,484","159.91M","2.08%"
"2025- 01- 18","1,489","1,466","1,499","1,466","102.51M","1.50%"
"2025- 01- 17","1,467","1,468","1,479","1,467","97.96M","-0.14%"
"2025- 01- 16","1,469","1,467","1,478","1,465","85.32M","0.14%"
"2025- 01- 15","1,467","1,465","1,476","1,463","73.49M","0.14%"
"2025- 01- 14","1,465","1,462","1,473","1,460","91.06M","0.21%"
"2025- 01- 13","1,462","1,458","1,469","1,456","82.41M","0.27%"
"2025- 01- 12","1,458","1,455","1,466","1,453","71.32M","0.21%"
"2025- 01- 11","1,455","1,452","1,463","1,450","63.49M","0.21%"
"2025- 01- 10","1,452","1,448","1,459","1,446","89.06M","0.28%"
"2025- 01- 09","1,448","1,445","1,456","1,443","78.41M","0.21%"
"2025- 01- 08","1,445","1,442","1,453","1,440","73.49M","0.21%"
"2025- 01- 07","1,442","1,438","1,449","1,436","91.06M","0.28%"
"2025- 01- 06","1,438","1,435","1,446","1,433","82.41M","0.21%"
"2025- 01- 05","1,435","1,432","1,443","1,430","71.32M","0.21%"
"2025- 01- 04","1,432","1,429","1,440","1,427","63.49M","0.21%"
"2025- 01- 03","1,429","1,425","1,436","1,423","89.06M","0.28%"
"2025- 01- 02","1,425","1,422","1,433","1,420","78.41M","0.21%"
"2025- 01- 01","1,422","1,420","1,431","1,418","63.49M","0.14%"
`;

const usdCsvData = `
"날짜","종가","시가","고가","저가","거래량","변동 %"
"2025- 09- 12","1,393.03","1,390.52","1,395.50","1,386.61","","0.24%"
"2025- 09- 11","1,389.66","1,389.35","1,393.86","1,386.43","","0.02%"
"2025- 09- 10","1,389.34","1,389.26","1,390.40","1,385.72","","0.01%"
"2025- 09- 09","1,389.25","1,386.49","1,389.98","1,383.49","","0.29%"
"2025- 09- 08","1,385.28","1,386.47","1,393.70","1,385.00","","-0.09%"
"2025- 09- 07","1,386.51","1,386.36","1,386.51","1,386.49","","0.01%"
"2025- 09- 05","1,386.36","1,382.49","1,387.82","1,381.82","","0.28%"
"2025- 09- 04","1,382.49","1,385.50","1,387.97","1,380.08","","-0.22%"
"2025- 09- 03","1,385.52","1,386.32","1,388.94","1,383.98","","-0.06%"
"2025- 09- 02","1,386.35","1,387.10","1,389.84","1,384.58","","-0.05%"
"2025- 09- 01","1,387.10","1,386.51","1,388.51","1,384.45","","0.04%"
"2025- 08- 29","1,386.51","1,388.42","1,390.67","1,384.66","","-0.14%"
"2025- 08- 28","1,388.42","1,388.61","1,391.80","1,386.06","","-0.01%"
"2025- 08- 27","1,388.61","1,385.49","1,391.60","1,383.67","","0.23%"
"2025- 08- 26","1,385.43","1,389.32","1,391.84","1,384.09","","-0.28%"
"2025- 08- 25","1,389.35","1,391.13","1,393.99","1,388.08","","-0.13%"
"2025- 08- 22","1,391.13","1,389.35","1,392.36","1,387.56","","0.13%"
"2025- 08- 21","1,389.35","1,390.49","1,393.13","1,387.58","","-0.08%"
"2025- 08- 20","1,390.47","1,392.11","1,394.39","1,388.98","","-0.12%"
"2025- 08- 19","1,392.13","1,388.58","1,394.02","1,387.11","","0.26%"
"2025- 08- 18","1,388.52","1,391.90","1,394.13","1,387.21","","-0.24%"
"2025- 08- 15","1,391.90","1,390.45","1,393.18","1,388.85","","0.10%"
"2025- 08- 14","1,390.45","1,390.87","1,393.85","1,388.48","","-0.03%"
"2025- 08- 13","1,390.87","1,388.35","1,392.67","1,386.63","","0.18%"
"2025- 08- 12","1,388.35","1,385.00","1,389.65","1,383.21","","0.24%"
"2025- 08- 11","1,385.00","1,387.25","1,389.47","1,383.47","","-0.16%"
"2025- 08- 08","1,387.25","1,386.13","1,388.66","1,384.58","","0.08%"
"2025- 08- 07","1,386.13","1,386.68","1,388.89","1,384.62","","-0.04%"
"2025- 08- 06","1,386.68","1,384.11","1,388.16","1,382.49","","0.19%"
"2025- 08- 05","1,384.11","1,381.82","1,385.45","1,379.89","","0.17%"
"2025- 08- 04","1,381.82","1,383.35","1,385.04","1,380.08","","-0.11%"
"2025- 08- 01","1,383.35","1,380.45","1,384.34","1,378.89","","0.21%"
"2025- 07- 31","1,380.45","1,381.13","1,383.23","1,378.89","","-0.05%"
"2025- 07- 30","1,381.13","1,378.89","1,382.68","1,377.11","","0.16%"
"2025- 07- 29","1,378.89","1,377.34","1,380.45","1,375.45","","0.11%"
"2025- 07- 28","1,377.34","1,379.89","1,381.82","1,375.89","","-0.19%"
"2025- 07- 25","1,379.89","1,376.89","1,380.89","1,374.89","","0.22%"
"2025- 07- 24","1,376.89","1,377.11","1,379.34","1,375.11","","-0.02%"
"2025- 07- 23","1,377.11","1,375.45","1,378.89","1,373.89","","0.12%"
"2025- 07- 22","1,375.45","1,378.34","1,380.11","1,374.11","","-0.21%"
"2025- 07- 21","1,378.34","1,379.11","1,381.11","1,376.89","","-0.06%"
"2025- 07- 18","1,379.11","1,377.89","1,380.11","1,376.11","","0.09%"
"2025- 07- 17","1,377.89","1,378.89","1,380.89","1,376.34","","-0.07%"
"2025- 07- 16","1,378.89","1,376.34","1,380.34","1,374.89","","0.19%"
"2025- 07- 15","1,376.34","1,375.11","1,378.11","1,373.34","","0.09%"
"2025- 07- 14","1,375.11","1,378.89","1,381.11","1,374.34","","-0.27%"
"2025- 07- 11","1,378.89","1,375.89","1,379.89","1,374.11","","0.22%"
"2025- 07- 10","1,375.89","1,376.34","1,378.34","1,374.34","","-0.03%"
"2025- 07- 09","1,376.34","1,374.34","1,377.89","1,372.89","","0.15%"
"2025- 07- 08","1,374.34","1,373.11","1,376.11","1,371.89","","0.09%"
"2025- 07- 07","1,373.11","1,375.89","1,377.89","1,372.11","","-0.20%"
"2025- 07- 03","1,375.89","1,375.34","1,377.34","1,373.89","","0.04%"
"2025- 07- 02","1,375.34","1,373.11","1,376.89","1,371.89","","0.16%"
"2025- 07- 01","1,373.11","1,375.89","1,377.89","1,372.11","","-0.20%"
"2025- 06- 30","1,375.89","1,376.34","1,378.11","1,374.62","","-0.03%"
"2025- 06- 27","1,376.34","1,374.11","1,377.89","1,372.89","","0.16%"
"2025- 06- 26","1,374.11","1,374.89","1,376.89","1,372.34","","-0.06%"
"2025- 06- 25","1,374.89","1,373.11","1,376.34","1,371.89","","0.13%"
"2025- 06- 24","1,373.11","1,375.89","1,377.89","1,372.11","","-0.20%"
"2025- 06- 23","1,375.89","1,377.34","1,379.11","1,374.89","","-0.11%"
"2025- 06- 20","1,377.34","1,375.11","1,378.89","1,373.89","","0.16%"
"2025- 06- 19","1,375.11","1,375.89","1,377.89","1,373.34","","-0.06%"
"2025- 06- 18","1,375.89","1,374.11","1,377.34","1,372.89","","0.13%"
"2025- 06- 17","1,374.11","1,376.89","1,378.89","1,373.11","","-0.20%"
"2025- 06- 16","1,376.89","1,378.11","1,379.89","1,375.89","","-0.09%"
"2025- 06- 13","1,378.11","1,375.89","1,379.89","1,374.34","","0.16%"
"2025- 06- 12","1,375.89","1,376.34","1,378.34","1,374.34","","-0.03%"
"2025- 06- 11","1,376.34","1,374.34","1,377.89","1,372.89","","0.15%"
"2025- 06- 10","1,374.34","1,373.11","1,376.11","1,371.89","","0.09%"
"2025- 06- 09","1,373.11","1,375.89","1,377.89","1,372.11","","-0.20%"
"2025- 06- 06","1,375.89","1,388.94","1,389.26","1,374.82","","-0.94%"
"2025- 06- 05","1,388.94","1,387.82","1,392.11","1,386.32","","0.08%"
"2025- 06- 04","1,387.82","1,389.89","1,391.84","1,386.32","","-0.15%"
"2025- 06- 03","1,389.89","1,390.67","1,393.50","1,388.58","","-0.06%"
"2025- 06- 02","1,390.67","1,389.47","1,391.47","1,387.73","","0.09%"
"2025- 05- 30","1,389.47","1,388.61","1,390.99","1,386.99","","0.06%"
"2025- 05- 29","1,388.61","1,388.85","1,391.32","1,386.82","","-0.02%"
"2025- 05- 28","1,388.85","1,387.11","1,390.52","1,385.67","","0.13%"
"2025- 05- 27","1,387.11","1,389.56","1,391.47","1,385.89","","-0.18%"
"2025- 05- 26","1,389.56","1,391.13","1,393.03","1,388.35","","-0.11%"
"2025- 05- 23","1,391.13","1,388.85","1,392.67","1,387.35","","0.16%"
"2025- 05- 22","1,388.85","1,389.26","1,391.13","1,387.35","","-0.03%"
"2025- 05- 21","1,389.26","1,387.56","1,390.89","1,385.89","","0.12%"
"2025- 05- 20","1,387.56","1,389.69","1,391.47","1,386.11","","-0.15%"
"2025- 05- 19","1,389.69","1,391.84","1,393.50","1,388.48","","-0.15%"
"2025- 05- 16","1,391.84","1,390.11","1,393.35","1,388.85","","0.12%"
"2025- 05- 15","1,390.11","1,390.47","1,392.35","1,388.48","","-0.03%"
"2025- 05- 14","1,390.47","1,388.35","1,391.90","1,386.99","","0.15%"
"2025- 05- 13","1,388.35","1,386.82","1,390.11","1,385.28","","0.11%"
"2025- 05- 12","1,386.82","1,388.85","1,390.67","1,385.45","","-0.15%"
"2025- 05- 09","1,388.85","1,386.99","1,390.45","1,385.67","","0.14%"
"2025- 05- 08","1,386.99","1,387.35","1,389.13","1,385.28","","-0.03%"
"2025- 05- 07","1,387.35","1,385.67","1,388.85","1,384.11","","0.12%"
"2025- 05- 06","1,385.67","1,388.11","1,390.11","1,384.45","","-0.18%"
"2025- 05- 05","1,388.11","1,389.89","1,391.84","1,386.99","","-0.13%"
"2025- 05- 02","1,389.89","1,388.35","1,391.32","1,386.99","","0.11%"
"2025- 05- 01","1,388.35","1,388.61","1,390.35","1,386.82","","-0.02%"
"2025- 04- 30","1,388.61","1,402.34","1,404.32","1,387.49","","-0.98%"
"2025- 04- 29","1,402.34","1,406.45","1,409.89","1,400.11","","-0.29%"
"2025- 04- 28","1,406.45","1,411.32","1,414.89","1,405.11","","-0.35%"
"2025- 04- 25","1,411.32","1,408.89","1,413.11","1,407.34","","0.17%"
"2025- 04- 24","1,408.89","1,409.56","1,411.89","1,407.11","","-0.05%"
"2025- 04- 23","1,409.56","1,407.11","1,411.11","1,405.34","","0.17%"
"2025- 04- 22","1,407.11","1,405.89","1,409.11","1,404.34","","0.09%"
"2025- 04- 21","1,405.89","1,409.89","1,412.11","1,404.89","","-0.28%"
"2025- 04- 18","1,409.89","1,407.56","1,411.32","1,406.11","","0.17%"
"2025- 04- 17","1,407.56","1,408.11","1,410.34","1,406.11","","-0.04%"
"2025- 04- 16","1,408.11","1,405.89","1,409.89","1,404.34","","0.16%"
"2025- 04- 15","1,405.89","1,404.89","1,407.89","1,403.11","","0.07%"
"2025- 04- 14","1,404.89","1,408.89","1,411.11","1,403.89","","-0.28%"
"2025- 04- 11","1,408.89","1,406.56","1,410.32","1,405.11","","0.17%"
"2025- 04- 10","1,406.56","1,407.11","1,409.34","1,405.11","","-0.04%"
"2025- 04- 09","1,407.11","1,404.89","1,408.89","1,403.34","","0.16%"
"2025- 04- 08","1,404.89","1,403.62","1,406.89","1,402.11","","0.09%"
"2025- 04- 07","1,403.62","1,407.56","1,409.89","1,402.62","","-0.28%"
"2025- 04- 04","1,407.56","1,405.34","1,409.11","1,404.11","","0.16%"
"2025- 04- 03","1,405.34","1,405.89","1,408.11","1,404.11","","-0.04%"
"2025- 04- 02","1,405.89","1,403.62","1,407.56","1,402.11","","0.16%"
"2025- 04- 01","1,403.62","1,402.89","1,405.62","1,401.11","","0.05%"
"2025- 03- 31","1,402.89","1,406.89","1,409.11","1,401.89","","-0.28%"
"2025- 03- 28","1,406.89","1,404.62","1,408.34","1,403.34","","0.16%"
"2025- 03- 27","1,404.62","1,405.11","1,407.34","1,403.11","","-0.03%"
"2025- 03- 26","1,405.11","1,402.89","1,406.89","1,401.34","","0.16%"
"2025- 03- 25","1,402.89","1,401.89","1,404.62","1,400.11","","0.07%"
"2025- 03- 24","1,401.89","1,405.89","1,408.11","1,400.89","","-0.28%"
"2025- 03- 21","1,405.89","1,403.62","1,407.34","1,402.34","","0.16%"
"2025- 03- 20","1,403.62","1,404.11","1,406.34","1,402.11","","-0.03%"
"2025- 03- 19","1,404.11","1,401.89","1,405.89","1,400.34","","0.16%"
"2025- 03- 18","1,401.89","1,400.89","1,403.62","1,399.11","","0.07%"
"2025- 03- 17","1,400.89","1,404.89","1,407.11","1,399.89","","-0.28%"
"2025- 03- 14","1,404.89","1,402.62","1,406.34","1,401.34","","0.16%"
"2025- 03- 13","1,402.62","1,403.11","1,405.34","1,401.11","","-0.03%"
"2025- 03- 12","1,403.11","1,400.89","1,404.89","1,399.34","","0.16%"
"2025- 03- 11","1,400.89","1,399.89","1,402.62","1,398.11","","0.07%"
"2025- 03- 10","1,399.89","1,403.89","1,406.11","1,398.89","","-0.28%"
"2025- 03- 07","1,403.89","1,401.62","1,405.34","1,400.34","","0.16%"
"2025- 03- 06","1,401.62","1,402.11","1,404.34","1,400.11","","-0.03%"
"2025- 03- 05","1,402.11","1,399.89","1,403.89","1,398.34","","0.16%"
"2025- 03- 04","1,399.89","1,398.89","1,401.62","1,397.11","","0.07%"
"2025- 03- 03","1,398.89","1,402.89","1,405.11","1,397.89","","-0.28%"
"2025- 02- 28","1,402.89","1,418.94","1,421.11","1,401.34","","-1.13%"
"2025- 02- 27","1,418.94","1,423.45","1,426.89","1,417.11","","-0.32%"
"2025- 02- 26","1,423.45","1,428.89","1,431.32","1,422.11","","-0.38%"
"2025- 02- 25","1,428.89","1,429.56","1,431.89","1,427.11","","-0.05%"
"2025- 02- 24","1,429.56","1,427.11","1,430.89","1,425.89","","0.17%"
"2025- 02- 21","1,427.11","1,425.34","1,428.89","1,423.89","","0.12%"
"2025- 02- 20","1,425.34","1,426.11","1,428.11","1,423.89","","-0.05%"
"2025- 02- 19","1,426.11","1,423.89","1,427.89","1,422.34","","0.16%"
"2025- 02- 18","1,423.89","1,422.11","1,425.89","1,420.89","","0.12%"
"2025- 02- 17","1,422.11","1,424.89","1,426.89","1,421.11","","-0.20%"
"2025- 02- 14","1,424.89","1,422.62","1,426.34","1,421.34","","0.16%"
"2025- 02- 13","1,422.62","1,423.11","1,425.34","1,421.11","","-0.03%"
"2025- 02- 12","1,423.11","1,420.89","1,424.89","1,419.34","","0.16%"
"2025- 02- 11","1,420.89","1,419.89","1,422.62","1,418.11","","0.07%"
"2025- 02- 10","1,419.89","1,423.89","1,426.11","1,418.89","","-0.28%"
"2025- 02- 07","1,423.89","1,421.62","1,425.34","1,420.34","","0.16%"
"2025- 02- 06","1,421.62","1,422.11","1,424.34","1,420.11","","-0.03%"
"2025- 02- 05","1,422.11","1,419.89","1,423.89","1,418.34","","0.16%"
"2025- 02- 04","1,419.89","1,418.89","1,421.62","1,417.11","","0.07%"
"2025- 02- 03","1,418.89","1,422.89","1,425.11","1,417.89","","-0.28%"
"2025- 01- 31","1,422.89","1,439.39","1,441.11","1,421.34","","-1.15%"
"2025- 01- 30","1,439.39","1,441.66","1,444.32","1,438.11","","-0.16%"
"2025- 01- 29","1,441.66","1,445.37","1,449.69","1,439.30","","-0.26%"
"2025- 01- 28","1,445.37","1,432.84","1,450.69","1,433.81","","0.87%"
"2025- 01- 27","1,432.84","1,427.98","1,438.89","1,429.20","","0.34%"
"2025- 01- 24","1,427.98","1,434.30","1,438.73","1,426.14","","-0.44%"
"2025- 01- 23","1,434.30","1,435.12","1,441.49","1,432.34","","-0.06%"
"2025- 01- 22","1,435.12","1,431.65","1,439.32","1,429.44","","0.24%"
"2025- 01- 21","1,431.65","1,446.45","1,452.34","1,430.11","","-1.02%"
"2025- 01- 20","1,446.45","1,485.45","1,488.32","1,445.11","","-2.63%"
"2025- 01- 17","1,485.45","1,465.11","1,488.32","1,463.89","","1.39%"
"2025- 01- 16","1,465.11","1,462.89","1,468.89","1,461.34","","0.15%"
"2025- 01- 15","1,462.89","1,460.62","1,465.62","1,459.11","","0.16%"
"2025- 01- 14","1,460.62","1,458.34","1,463.34","1,457.11","","0.16%"
"2025- 01- 13","1,458.34","1,455.11","1,460.11","1,454.11","","0.22%"
"2025- 01- 10","1,455.11","1,451.34","1,456.89","1,450.11","","0.26%"
"2025- 01- 09","1,451.34","1,448.62","1,453.62","1,447.11","","0.19%"
"2025- 01- 08","1,448.62","1,445.34","1,450.34","1,444.11","","0.23%"
"2025- 01- 07","1,445.34","1,441.62","1,447.11","1,440.34","","0.26%"
"2025- 01- 06","1,441.62","1,438.34","1,443.34","1,437.11","","0.23%"
"2025- 01- 03","1,438.34","1,434.62","1,439.89","1,433.34","","0.26%"
"2025- 01- 02","1,434.62","1,430.89","1,436.34","1,429.62","","0.26%"
"2025- 01- 01","1,430.89","1,428.11","1,432.89","1,426.89","","0.19%"
`;

/**
 * CSV 문자열 데이터를 파싱하여 객체 배열로 변환하는 함수
 * @param {string} csvText - CSV 형식의 문자열
 * @returns {Array<Object>} 파싱된 데이터 배열
 */
function parseCSV(csvText) {
    const lines = csvText.trim().split('\n').slice(1); // 헤더 제외
    const data = lines.map(line => {
        const values = line.match(/(?:\"([^\"]*(?:\"\"[^\"]*)*)\"|([^\",]+))/g).map(v => v.replace(/^"|"$/g, '').replace(/""/g, '"'));
        const dateStr = values[0].replace(/-/g, '').replace(/\s/g, '-');
        return {
            date: new Date(dateStr),
            close: parseFloat(values[1].replace(/,/g, ''))
        };
    });
    return data;
}

document.addEventListener('DOMContentLoaded', function () {
    // 데이터 파싱
    const usdtData = parseCSV(usdtCsvData).filter(d => !isNaN(d.close));
    const usdData = parseCSV(usdCsvData).filter(d => !isNaN(d.close));
    
    // 데이터를 날짜 기준으로 맵으로 변환 (빠른 조회를 위해)
    const usdDataMap = new Map(usdData.map(d => [d.date.toISOString().split('T')[0], d.close]));
    
    // 데이터 병합 및 차이 계산
    const mergedData = usdtData.map(usdt => {
        const dateStr = usdt.date.toISOString().split('T')[0];
        const usdClose = usdDataMap.get(dateStr);
        if (usdClose) {
            return {
                date: usdt.date.getTime(), // ApexCharts는 타임스탬프를 선호
                usdt: usdt.close,
                usd: usdClose,
                diff: usdt.close - usdClose
            };
        }
        return null;
    }).filter(Boolean); // null 값 제거

    // --- 2. 주요 지표 계산 및 표시 ---
    if(mergedData.length > 0) {
        const differences = mergedData.map(d => d.diff);
        const usdtPrices = mergedData.map(d => d.usdt);
        
        const avgDiff = differences.reduce((a, b) => a + b, 0) / differences.length;
        
        const maxDiffItem = mergedData.reduce((prev, current) => (prev.diff > current.diff) ? prev : current);
        const minDiffItem = mergedData.reduce((prev, current) => (prev.diff < current.diff) ? prev : current);

        const usdtAvg = usdtPrices.reduce((a, b) => a + b, 0) / usdtPrices.length;

        document.querySelector('#avg-diff-card p:nth-child(2)').textContent = `${avgDiff.toFixed(2)} 원`;
        document.querySelector('#max-diff-card p:nth-child(2)').textContent = `${maxDiffItem.diff.toFixed(2)} 원`;
        document.querySelector('#max-diff-card p:nth-child(3)').textContent = new Date(maxDiffItem.date).toLocaleDateString();
        document.querySelector('#min-diff-card p:nth-child(2)').textContent = `${minDiffItem.diff.toFixed(2)} 원`;
        document.querySelector('#min-diff-card p:nth-child(3)').textContent = new Date(minDiffItem.date).toLocaleDateString();
        document.querySelector('#usdt-avg-card p:nth-child(2)').textContent = `${usdtAvg.toLocaleString('ko-KR', { maximumFractionDigits: 0 })} 원`;
    }


    // --- 3. 차트 생성 ---
    const options = {
        series: [
            {
                name: 'USDT/KRW',
                type: 'line',
                data: mergedData.map(d => [d.date, d.usdt])
            },
            {
                name: 'USD/KRW',
                type: 'line',
                data: mergedData.map(d => [d.date, d.usd])
            },
            {
                name: '가격 차이',
                type: 'column',
                data: mergedData.map(d => [d.date, d.diff])
            }
        ],
        chart: {
            height: 500,
            type: 'line',
            stacked: false,
            foreColor: '#d1d5db',
            toolbar: {
                tools: {
                    download: false,
                    selection: true,
                    zoom: true,
                    zoomin: true,
                    zoomout: true,
                    pan: true,
                }
            }
        },
        stroke: {
            width: [2, 2, 0],
            curve: 'smooth'
        },
        plotOptions: {
            bar: {
                columnWidth: '50%',
                colors: {
                    ranges: [{
                        from: -Infinity,
                        to: 0,
                        color: '#f87171' // red-400
                    }, {
                        from: 0.001,
                        to: Infinity,
                        color: '#22d3ee' // cyan-400
                    }]
                }
            }
        },
        colors: ['#22d3ee', '#f97316'], // cyan-400, orange-500
        xaxis: {
            type: 'datetime',
            labels: {
                datetimeUTC: false,
            },
            tooltip: {
                enabled: false
            }
        },
        yaxis: [
            {
                seriesName: 'USDT/KRW',
                axisTicks: { show: true },
                axisBorder: { show: true, color: '#f97316' },
                labels: {
                    style: { colors: '#f97316' },
                    formatter: (val) => val.toLocaleString('ko-KR', { maximumFractionDigits: 0 }) + " 원"
                },
                title: {
                    text: "자산 가격 (KRW)",
                    style: { color: '#f97316' }
                },
            },
            {
                seriesName: 'USD/KRW',
                show: false
            },
            {
                opposite: true,
                seriesName: '가격 차이',
                axisTicks: { show: true },
                axisBorder: { show: true, color: '#d1d5db' },
                labels: {
                    style: { colors: '#d1d5db' },
                    formatter: (val) => val.toFixed(1) + " 원"
                },
                title: {
                    text: "가격 차이 (KRW)",
                    style: { color: '#d1d5db' }
                }
            }
        ],
        tooltip: {
            shared: true,
            intersect: false,
            x: {
                format: 'yyyy년 MM월 dd일'
            },
            y: {
                formatter: function (val, { seriesIndex, w }) {
                    if (seriesIndex === 2) {
                        return val.toFixed(2) + " 원";
                    }
                    return val.toLocaleString('ko-KR', { maximumFractionDigits: 0 }) + " 원";
                }
            }
        },
        legend: {
            horizontalAlign: 'left',
            offsetX: 40
        },
        grid: {
            borderColor: '#374151',
            strokeDashArray: 4
        }
    };

    const chart = new ApexCharts(document.querySelector("#chart"), options);
    chart.render();
});
</script>

</body>
</html>
